#!/usr/bin/env ruby

# Script to switch between sandbox and production environments
require 'fileutils'

puts "üîÑ TastyTrade Environment Switcher"
puts "=" * 50
puts

puts "Current environment files:"
puts "- .env (production)"
puts "- .env.sandbox (sandbox)"
puts "- .env.local (your local overrides - git ignored)"
puts

puts "Select environment:"
puts "1. Sandbox (for testing)"
puts "2. Production (real trading)"
puts "3. Development (local testing)"
print "\nChoice (1-3): "

choice = gets.chomp

case choice
when '1'
  # Switch to sandbox
  if File.exist?('.env.sandbox')
    FileUtils.cp('.env.sandbox', '.env.local')
    puts "‚úÖ Switched to SANDBOX environment"
    puts
    puts "Next steps:"
    puts "1. Get sandbox credentials from https://developer.tastytrade.com/"
    puts "2. Update .env.local with your sandbox username/password"
    puts "3. Run: RAILS_ENV=sandbox rails server"
    puts
    puts "Sandbox API: https://api.cert.tastyworks.com"
  else
    puts "‚ùå .env.sandbox file not found!"
  end
  
when '2'
  # Switch to production
  if File.exist?('.env')
    FileUtils.cp('.env', '.env.local')
    puts "‚ö†Ô∏è  Switched to PRODUCTION environment"
    puts
    puts "WARNING: This will execute REAL trades with REAL money!"
    puts
    puts "Next steps:"
    puts "1. Update .env.local with your REAL TastyTrade credentials"
    puts "2. Run: RAILS_ENV=production rails server"
    puts
    puts "Production API: https://api.tastyworks.com"
  else
    puts "‚ùå .env file not found!"
  end
  
when '3'
  # Development mode
  puts "üîß Development mode uses .env or .env.local"
  puts
  puts "You can use either:"
  puts "- Sandbox credentials for safe testing"
  puts "- Production credentials (be careful!)"
  puts
  puts "Run: rails server"
  
else
  puts "‚ùå Invalid choice"
  exit 1
end

puts
puts "Environment files:"
puts "- .env.local (active config - edit this one)"
puts "- .env (template - don't edit)"
puts "- .env.sandbox (template - don't edit)"
puts
puts "Remember:"
puts "- Sandbox and production use DIFFERENT credentials"
puts "- Sandbox account: https://developer.tastytrade.com/"
puts "- Production account: Your regular TastyTrade login"